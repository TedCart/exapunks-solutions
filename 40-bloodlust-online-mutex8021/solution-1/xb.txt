LINK 800
COPY M X
COPY 6 T
MARK DISPATCHTALLY
REPL TALLYHO
SUBI T 1 T
TJMP DISPATCHTALLY

MARK TALLYHO
ADDI T 799 T
LINK T
GRAB 200
SEEK 1
MARK SEARCHTALLY
TEST X = F
TJMP TALLYFOUND
SEEK 2
JUMP SEARCHTALLY

MARK TALLYFOUND
COPY M X
SEEK -9999
SEEK 1
MARK SEARCHMAP
TEST X = F
TJMP MAPFOUND
SEEK 2
JUMP SEARCHMAP

MARK MAPFOUND
MODE;SWITCH TO LOCAL
REPL VAMPBRANCH
COPY F M;SEND HOSTNAME

MODE;SWITCH TO GLOBAL
COPY M X;GET DOOR
SEEK -9999
SEEK 1
MARK SEARCHDOOR
TEST X = F
TJMP DOORFOUND
SEEK 2
JUMP SEARCHDOOR

MARK DOORFOUND
COPY X M;SEND DOOR
COPY F M;SEND UNLOCKED
HALT

MARK VAMPBRANCH
COPY M X;REC HOSTNAME
LINK -1
COPY 6 T
MARK DISPATCHVAMP
REPL VAMPHUNTER
SUBI T 1 T
TJMP DISPATCHVAMP

MARK VAMPHUNTER
ADDI T 799 T
LINK T
HOST T
TEST X = T
FJMP END
MODE;SWITCH TO GLOBAL
COPY M X;GET DOOR
KILL
KILL
KILL
KILL
KILL
GRAB 200
SEEK 1
MARK SEARCHDOOR2
TEST X = F
TJMP DOORFOUND2
SEEK 2
JUMP SEARCHDOOR2

MARK DOORFOUND2
COPY M F;WRITE UNLOCKED
COPY M X;GET SAFE
SEEK -9999
SEEK 1
MARK SEARCHSAFE
TEST X = F
TJMP SAFEFOUND
SEEK 2
JUMP SEARCHSAFE

MARK SAFEFOUND
MODE;SWITCH TO LOCAL
REPL COMBOKEEPER
COPY F M;SND COMBINATION
MODE;SWITCH GLOBAL
COPY M X;GET CLOCK
SEEK -9999
SEEK 1
MARK SEARCHCLOCK
TEST X = F
TJMP CLOCKFOUND
SEEK 2
JUMP SEARCHCLOCK

MARK CLOCKFOUND
MODE;SWITCH LOCAL
COPY M F
HALT

MARK COMBOKEEPER
COPY M X;REC COMBINATION
COPY X M;SEND COMBO BACK

MARK END
